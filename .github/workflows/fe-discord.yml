name: Discord Notifications

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened, labeled]
  pull_request_review:
    types: [submitted]

env:
  harry: "harry"
  ssunday: "useon"

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: 새로운 이슈가 등록되면 디스코드 알림을 보낸다.
        if: github.event.issue && contains(github.event.issue.title, '[FE]')
        env:
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          curl -H "Content-Type: application/json" \
          -d "{\"content\": \"New FE issue opened: ${{ github.event.issue.html_url }}\"}" \
          $DISCORD_WEBHOOK_URL

      - name: 새로운 PR이 등록되면 디스코드 알림을 보낸다.
        if: github.event.pull_request && contains(github.event.pull_request.title, '[FE]')
        env:
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          curl -H "Content-Type: application/json" \
          -d "{\"content\": \"New frontend PR opened: ${{ github.event.pull_request.html_url }}\"}" \
          $DISCORD_WEBHOOK_URL

      - name: Send Discord notification for PR review
        if: github.event.review && (github.event.review.user.login == env.harry || github.event.review.user.login == env.ssunday)
        env:
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          curl -H "Content-Type: application/json" \
          -d "{\"content\": \"New review submitted for PR: ${{ github.event.pull_request.html_url }}\"}" \
          $DISCORD_WEBHOOK_URL
